import path from "path";
import { viteifyURL } from "../util.js";
const STYLE_EXTENSIONS = new Set([".css", ".pcss", ".postcss", ".scss", ".sass", ".styl", ".stylus", ".less"]);
function getStylesForURL(filePath, viteServer) {
  const css = new Set();
  const rootID = viteifyURL(filePath);
  function crawlCSS(entryModule, scanned = new Set()) {
    const moduleName = viteServer.moduleGraph.urlToModuleMap.get(entryModule);
    if (!moduleName || !moduleName.id)
      return;
    scanned.add(moduleName.url);
    for (const importedModule of moduleName.importedModules) {
      if (!importedModule.url || scanned.has(importedModule.url))
        continue;
      const ext = path.extname(importedModule.url.toLowerCase());
      if (STYLE_EXTENSIONS.has(ext)) {
        css.add(importedModule.url);
      } else {
        crawlCSS(importedModule.url, scanned);
      }
      scanned.add(importedModule.url);
    }
  }
  crawlCSS(rootID);
  return css;
}
export {
  STYLE_EXTENSIONS,
  getStylesForURL
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vLi4vLi4vc3JjL2NvcmUvc3NyL2Nzcy50cyJdLAogICJtYXBwaW5ncyI6ICJBQUVBO0FBQ0E7QUFHTyxNQUFNLG1CQUFtQixJQUFJLElBQUksQ0FBQyxRQUFRLFNBQVMsWUFBWSxTQUFTLFNBQVMsU0FBUyxXQUFXO0FBR3JHLHlCQUF5QixVQUFlLFlBQTZDO0FBQzFGLFFBQU0sTUFBTSxJQUFJO0FBQ2hCLFFBQU0sU0FBUyxXQUFXO0FBRzFCLG9CQUFrQixhQUFxQixVQUFVLElBQUksT0FBZTtBQUNsRSxVQUFNLGFBQWEsV0FBVyxZQUFZLGVBQWUsSUFBSTtBQUM3RCxRQUFJLENBQUMsY0FBYyxDQUFDLFdBQVc7QUFBSTtBQUVuQyxZQUFRLElBQUksV0FBVztBQUN2QixlQUFXLGtCQUFrQixXQUFXLGlCQUFpQjtBQUN2RCxVQUFJLENBQUMsZUFBZSxPQUFPLFFBQVEsSUFBSSxlQUFlO0FBQU07QUFDNUQsWUFBTSxNQUFNLEtBQUssUUFBUSxlQUFlLElBQUk7QUFDNUMsVUFBSSxpQkFBaUIsSUFBSSxNQUFNO0FBQzdCLFlBQUksSUFBSSxlQUFlO0FBQUEsYUFDbEI7QUFDTCxpQkFBUyxlQUFlLEtBQUs7QUFBQTtBQUUvQixjQUFRLElBQUksZUFBZTtBQUFBO0FBQUE7QUFHL0IsV0FBUztBQUVULFNBQU87QUFBQTsiLAogICJuYW1lcyI6IFtdCn0K
