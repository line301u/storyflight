import { getAttribute, hasAttribute, getTagName } from "@web/parse5-utils";
import { isStylesheetLink } from "./extract-assets.js";
const tagsWithSrcSet = new Set(["img", "source"]);
function startsWithSrcRoot(pathname, srcRoot, srcRootWeb) {
  return pathname.startsWith(srcRoot) || pathname.startsWith(srcRootWeb) || `/${pathname}`.startsWith(srcRoot);
}
function isInSrcDirectory(node, attr, srcRoot, srcRootWeb) {
  const value = getAttribute(node, attr);
  return value ? startsWithSrcRoot(value, srcRoot, srcRootWeb) : false;
}
function isAstroInjectedLink(node) {
  return isStylesheetLink(node) && getAttribute(node, "data-astro-injected") === "";
}
function isBuildableLink(node, srcRoot, srcRootWeb) {
  if (isAstroInjectedLink(node)) {
    return true;
  }
  const href = getAttribute(node, "href");
  if (typeof href !== "string" || !href.length) {
    return false;
  }
  return startsWithSrcRoot(href, srcRoot, srcRootWeb);
}
function isBuildableImage(node, srcRoot, srcRootWeb) {
  if (getTagName(node) === "img") {
    const src = getAttribute(node, "src");
    return src ? startsWithSrcRoot(src, srcRoot, srcRootWeb) : false;
  }
  return false;
}
function hasSrcSet(node) {
  return tagsWithSrcSet.has(getTagName(node)) && !!getAttribute(node, "srcset");
}
function isHoistedScript(node) {
  return getTagName(node) === "script" && hasAttribute(node, "hoist");
}
export {
  hasSrcSet,
  isAstroInjectedLink,
  isBuildableImage,
  isBuildableLink,
  isHoistedScript,
  isInSrcDirectory
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vLi4vc3JjL3ZpdGUtcGx1Z2luLWJ1aWxkLWh0bWwvdXRpbC50cyJdLAogICJtYXBwaW5ncyI6ICJBQUFBO0FBRUE7QUFFQSxNQUFNLGlCQUFpQixJQUFJLElBQUksQ0FBQyxPQUFPO0FBRXZDLDJCQUEyQixVQUFrQixTQUFpQixZQUE2QjtBQUN6RixTQUNFLFNBQVMsV0FBVyxZQUNwQixTQUFTLFdBQVcsZUFDcEIsSUFBSSxXQUFXLFdBQVc7QUFBQTtBQUl2QiwwQkFBMEIsTUFBc0IsTUFBYyxTQUFpQixZQUE2QjtBQUNqSCxRQUFNLFFBQVEsYUFBYSxNQUFNO0FBQ2pDLFNBQU8sUUFBUSxrQkFBa0IsT0FBTyxTQUFTLGNBQWM7QUFBQTtBQUcxRCw2QkFBNkIsTUFBK0I7QUFDakUsU0FBTyxpQkFBaUIsU0FBUyxhQUFhLE1BQU0sMkJBQTJCO0FBQUE7QUFHMUUseUJBQXlCLE1BQXNCLFNBQWlCLFlBQTZCO0FBQ2xHLE1BQUksb0JBQW9CLE9BQU87QUFDN0IsV0FBTztBQUFBO0FBR1QsUUFBTSxPQUFPLGFBQWEsTUFBTTtBQUNoQyxNQUFJLE9BQU8sU0FBUyxZQUFZLENBQUMsS0FBSyxRQUFRO0FBQzVDLFdBQU87QUFBQTtBQUdULFNBQU8sa0JBQWtCLE1BQU0sU0FBUztBQUFBO0FBR25DLDBCQUEwQixNQUFzQixTQUFpQixZQUE2QjtBQUNuRyxNQUFJLFdBQVcsVUFBVSxPQUFPO0FBQzlCLFVBQU0sTUFBTSxhQUFhLE1BQU07QUFDL0IsV0FBTyxNQUFNLGtCQUFrQixLQUFLLFNBQVMsY0FBYztBQUFBO0FBRTdELFNBQU87QUFBQTtBQUdGLG1CQUFtQixNQUErQjtBQUN2RCxTQUFPLGVBQWUsSUFBSSxXQUFXLFVBQVUsQ0FBQyxDQUFDLGFBQWEsTUFBTTtBQUFBO0FBRy9ELHlCQUF5QixNQUErQjtBQUM3RCxTQUFPLFdBQVcsVUFBVSxZQUFZLGFBQWEsTUFBTTtBQUFBOyIsCiAgIm5hbWVzIjogW10KfQo=
